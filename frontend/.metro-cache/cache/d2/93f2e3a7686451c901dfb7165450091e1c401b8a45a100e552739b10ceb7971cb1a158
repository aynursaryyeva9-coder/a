{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":38,"index":198}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const PRIVACY_ACCEPTED_KEY = 'vitamed_privacy_accepted';\n  function AuthProvider({\n    children\n  }) {\n    _s();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [hasAcceptedPrivacy, setHasAcceptedPrivacy] = (0, _react.useState)(false);\n    (0, _react.useEffect)(() => {\n      loadStoredAuth();\n    }, []);\n    const loadStoredAuth = async () => {\n      try {\n        // Check privacy policy acceptance\n        const privacyAccepted = await AsyncStorage.default.getItem(PRIVACY_ACCEPTED_KEY);\n        setHasAcceptedPrivacy(privacyAccepted === 'true');\n\n        // Check stored token\n        const storedToken = await AsyncStorage.default.getItem('vitamed_token');\n        if (storedToken) {\n          const response = await _servicesApi.api.get(`/auth/me?token=${storedToken}`);\n          setUser(response.data);\n          setToken(storedToken);\n        }\n      } catch (error) {\n        console.log('No stored auth or invalid token');\n        await AsyncStorage.default.removeItem('vitamed_token');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const acceptPrivacyPolicy = async () => {\n      await AsyncStorage.default.setItem(PRIVACY_ACCEPTED_KEY, 'true');\n      setHasAcceptedPrivacy(true);\n    };\n    const sendVerificationCode = async phone => {\n      const response = await _servicesApi.api.post('/auth/send-code', {\n        phone\n      });\n      return response.data.demo_code;\n    };\n    const verifyCode = async (phone, code) => {\n      const response = await _servicesApi.api.post('/auth/verify-code', {\n        phone,\n        code\n      });\n      return response.data.verified;\n    };\n    const login = async (phone, password) => {\n      const response = await _servicesApi.api.post('/auth/login', {\n        phone,\n        password\n      });\n      const {\n        access_token,\n        user: userData\n      } = response.data;\n      await AsyncStorage.default.setItem('vitamed_token', access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const register = async (phone, password, name) => {\n      const response = await _servicesApi.api.post('/auth/register', {\n        phone,\n        password,\n        name\n      });\n      const {\n        access_token,\n        user: userData\n      } = response.data;\n      await AsyncStorage.default.setItem('vitamed_token', access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('vitamed_token');\n      setToken(null);\n      setUser(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        token,\n        isLoading,\n        hasAcceptedPrivacy,\n        login,\n        register,\n        logout,\n        sendVerificationCode,\n        verifyCode,\n        acceptPrivacyPolicy\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 5\n    }, this);\n  }\n  _s(AuthProvider, \"Al1Tt1XKjHAX9Z1M4nGrd/QqNko=\");\n  _c = AuthProvider;\n  function useAuth() {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":137,"map":[[15,2,29,0,"exports"],[15,9,29,0],[15,10,29,0,"AuthProvider"],[15,22,29,0],[15,25,29,0,"AuthProvider"],[15,37,29,0],[16,2,117,0,"exports"],[16,9,117,0],[16,10,117,0,"useAuth"],[16,17,117,0],[16,20,117,0,"useAuth"],[16,27,117,0],[17,2,1,0],[17,6,1,0,"_react"],[17,12,1,0],[17,15,1,0,"require"],[17,22,1,0],[17,23,1,0,"_dependencyMap"],[17,37,1,0],[18,2,2,0],[18,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,2,0],[18,45,2,0,"require"],[18,52,2,0],[18,53,2,0,"_dependencyMap"],[18,67,2,0],[19,2,2,0],[19,6,2,0,"AsyncStorage"],[19,18,2,0],[19,21,2,0,"_interopDefault"],[19,36,2,0],[19,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,2,0],[20,2,3,0],[20,6,3,0,"_servicesApi"],[20,18,3,0],[20,21,3,0,"require"],[20,28,3,0],[20,29,3,0,"_dependencyMap"],[20,43,3,0],[21,2,3,38],[21,6,3,38,"_reactJsxDevRuntime"],[21,25,3,38],[21,28,3,38,"require"],[21,35,3,38],[21,36,3,38,"_dependencyMap"],[21,50,3,38],[22,2,25,0],[22,8,25,6,"AuthContext"],[22,19,25,17],[22,35,25,20],[22,39,25,20,"createContext"],[22,45,25,33],[22,46,25,33,"createContext"],[22,59,25,33],[22,61,25,63,"undefined"],[22,70,25,72],[22,71,25,73],[23,2,27,0],[23,8,27,6,"PRIVACY_ACCEPTED_KEY"],[23,28,27,26],[23,31,27,29],[23,57,27,55],[24,2,29,7],[24,11,29,16,"AuthProvider"],[24,23,29,28,"AuthProvider"],[24,24,29,29],[25,4,29,31,"children"],[26,2,29,65],[26,3,29,66],[26,5,29,68],[27,4,29,68,"_s"],[27,6,29,68],[28,4,30,2],[28,10,30,8],[28,11,30,9,"user"],[28,15,30,13],[28,17,30,15,"setUser"],[28,24,30,22],[28,25,30,23],[28,28,30,26],[28,32,30,26,"useState"],[28,38,30,34],[28,39,30,34,"useState"],[28,47,30,34],[28,49,30,48],[28,53,30,52],[28,54,30,53],[29,4,31,2],[29,10,31,8],[29,11,31,9,"token"],[29,16,31,14],[29,18,31,16,"setToken"],[29,26,31,24],[29,27,31,25],[29,30,31,28],[29,34,31,28,"useState"],[29,40,31,36],[29,41,31,36,"useState"],[29,49,31,36],[29,51,31,52],[29,55,31,56],[29,56,31,57],[30,4,32,2],[30,10,32,8],[30,11,32,9,"isLoading"],[30,20,32,18],[30,22,32,20,"setIsLoading"],[30,34,32,32],[30,35,32,33],[30,38,32,36],[30,42,32,36,"useState"],[30,48,32,44],[30,49,32,44,"useState"],[30,57,32,44],[30,59,32,45],[30,63,32,49],[30,64,32,50],[31,4,33,2],[31,10,33,8],[31,11,33,9,"hasAcceptedPrivacy"],[31,29,33,27],[31,31,33,29,"setHasAcceptedPrivacy"],[31,52,33,50],[31,53,33,51],[31,56,33,54],[31,60,33,54,"useState"],[31,66,33,62],[31,67,33,62,"useState"],[31,75,33,62],[31,77,33,63],[31,82,33,68],[31,83,33,69],[32,4,35,2],[32,8,35,2,"useEffect"],[32,14,35,11],[32,15,35,11,"useEffect"],[32,24,35,11],[32,26,35,12],[32,32,35,18],[33,6,36,4,"loadStoredAuth"],[33,20,36,18],[33,21,36,19],[33,22,36,20],[34,4,37,2],[34,5,37,3],[34,7,37,5],[34,9,37,7],[34,10,37,8],[35,4,39,2],[35,10,39,8,"loadStoredAuth"],[35,24,39,22],[35,27,39,25],[35,33,39,25,"loadStoredAuth"],[35,34,39,25],[35,39,39,37],[36,6,40,4],[36,10,40,8],[37,8,41,6],[38,8,42,6],[38,14,42,12,"privacyAccepted"],[38,29,42,27],[38,32,42,30],[38,38,42,36,"AsyncStorage"],[38,50,42,48],[38,51,42,48,"default"],[38,58,42,48],[38,59,42,49,"getItem"],[38,66,42,56],[38,67,42,57,"PRIVACY_ACCEPTED_KEY"],[38,87,42,77],[38,88,42,78],[39,8,43,6,"setHasAcceptedPrivacy"],[39,29,43,27],[39,30,43,28,"privacyAccepted"],[39,45,43,43],[39,50,43,48],[39,56,43,54],[39,57,43,55],[41,8,45,6],[42,8,46,6],[42,14,46,12,"storedToken"],[42,25,46,23],[42,28,46,26],[42,34,46,32,"AsyncStorage"],[42,46,46,44],[42,47,46,44,"default"],[42,54,46,44],[42,55,46,45,"getItem"],[42,62,46,52],[42,63,46,53],[42,78,46,68],[42,79,46,69],[43,8,47,6],[43,12,47,10,"storedToken"],[43,23,47,21],[43,25,47,23],[44,10,48,8],[44,16,48,14,"response"],[44,24,48,22],[44,27,48,25],[44,33,48,31,"api"],[44,45,48,34],[44,46,48,34,"api"],[44,49,48,34],[44,50,48,35,"get"],[44,53,48,38],[44,54,48,39],[44,72,48,57,"storedToken"],[44,83,48,68],[44,85,48,70],[44,86,48,71],[45,10,49,8,"setUser"],[45,17,49,15],[45,18,49,16,"response"],[45,26,49,24],[45,27,49,25,"data"],[45,31,49,29],[45,32,49,30],[46,10,50,8,"setToken"],[46,18,50,16],[46,19,50,17,"storedToken"],[46,30,50,28],[46,31,50,29],[47,8,51,6],[48,6,52,4],[48,7,52,5],[48,8,52,6],[48,15,52,13,"error"],[48,20,52,18],[48,22,52,20],[49,8,53,6,"console"],[49,15,53,13],[49,16,53,14,"log"],[49,19,53,17],[49,20,53,18],[49,53,53,51],[49,54,53,52],[50,8,54,6],[50,14,54,12,"AsyncStorage"],[50,26,54,24],[50,27,54,24,"default"],[50,34,54,24],[50,35,54,25,"removeItem"],[50,45,54,35],[50,46,54,36],[50,61,54,51],[50,62,54,52],[51,6,55,4],[51,7,55,5],[51,16,55,14],[52,8,56,6,"setIsLoading"],[52,20,56,18],[52,21,56,19],[52,26,56,24],[52,27,56,25],[53,6,57,4],[54,4,58,2],[54,5,58,3],[55,4,60,2],[55,10,60,8,"acceptPrivacyPolicy"],[55,29,60,27],[55,32,60,30],[55,38,60,30,"acceptPrivacyPolicy"],[55,39,60,30],[55,44,60,42],[56,6,61,4],[56,12,61,10,"AsyncStorage"],[56,24,61,22],[56,25,61,22,"default"],[56,32,61,22],[56,33,61,23,"setItem"],[56,40,61,30],[56,41,61,31,"PRIVACY_ACCEPTED_KEY"],[56,61,61,51],[56,63,61,53],[56,69,61,59],[56,70,61,60],[57,6,62,4,"setHasAcceptedPrivacy"],[57,27,62,25],[57,28,62,26],[57,32,62,30],[57,33,62,31],[58,4,63,2],[58,5,63,3],[59,4,65,2],[59,10,65,8,"sendVerificationCode"],[59,30,65,28],[59,33,65,31],[59,39,65,38,"phone"],[59,44,65,51],[59,48,65,73],[60,6,66,4],[60,12,66,10,"response"],[60,20,66,18],[60,23,66,21],[60,29,66,27,"api"],[60,41,66,30],[60,42,66,30,"api"],[60,45,66,30],[60,46,66,31,"post"],[60,50,66,35],[60,51,66,36],[60,68,66,53],[60,70,66,55],[61,8,66,57,"phone"],[62,6,66,63],[62,7,66,64],[62,8,66,65],[63,6,67,4],[63,13,67,11,"response"],[63,21,67,19],[63,22,67,20,"data"],[63,26,67,24],[63,27,67,25,"demo_code"],[63,36,67,34],[64,4,68,2],[64,5,68,3],[65,4,70,2],[65,10,70,8,"verifyCode"],[65,20,70,18],[65,23,70,21],[65,29,70,21,"verifyCode"],[65,30,70,28,"phone"],[65,35,70,41],[65,37,70,43,"code"],[65,41,70,55],[65,46,70,78],[66,6,71,4],[66,12,71,10,"response"],[66,20,71,18],[66,23,71,21],[66,29,71,27,"api"],[66,41,71,30],[66,42,71,30,"api"],[66,45,71,30],[66,46,71,31,"post"],[66,50,71,35],[66,51,71,36],[66,70,71,55],[66,72,71,57],[67,8,71,59,"phone"],[67,13,71,64],[68,8,71,66,"code"],[69,6,71,71],[69,7,71,72],[69,8,71,73],[70,6,72,4],[70,13,72,11,"response"],[70,21,72,19],[70,22,72,20,"data"],[70,26,72,24],[70,27,72,25,"verified"],[70,35,72,33],[71,4,73,2],[71,5,73,3],[72,4,75,2],[72,10,75,8,"login"],[72,15,75,13],[72,18,75,16],[72,24,75,16,"login"],[72,25,75,23,"phone"],[72,30,75,36],[72,32,75,38,"password"],[72,40,75,54],[72,45,75,59],[73,6,76,4],[73,12,76,10,"response"],[73,20,76,18],[73,23,76,21],[73,29,76,27,"api"],[73,41,76,30],[73,42,76,30,"api"],[73,45,76,30],[73,46,76,31,"post"],[73,50,76,35],[73,51,76,36],[73,64,76,49],[73,66,76,51],[74,8,76,53,"phone"],[74,13,76,58],[75,8,76,60,"password"],[76,6,76,69],[76,7,76,70],[76,8,76,71],[77,6,77,4],[77,12,77,10],[78,8,77,12,"access_token"],[78,20,77,24],[79,8,77,26,"user"],[79,12,77,30],[79,14,77,32,"userData"],[80,6,77,41],[80,7,77,42],[80,10,77,45,"response"],[80,18,77,53],[80,19,77,54,"data"],[80,23,77,58],[81,6,78,4],[81,12,78,10,"AsyncStorage"],[81,24,78,22],[81,25,78,22,"default"],[81,32,78,22],[81,33,78,23,"setItem"],[81,40,78,30],[81,41,78,31],[81,56,78,46],[81,58,78,48,"access_token"],[81,70,78,60],[81,71,78,61],[82,6,79,4,"setToken"],[82,14,79,12],[82,15,79,13,"access_token"],[82,27,79,25],[82,28,79,26],[83,6,80,4,"setUser"],[83,13,80,11],[83,14,80,12,"userData"],[83,22,80,20],[83,23,80,21],[84,4,81,2],[84,5,81,3],[85,4,83,2],[85,10,83,8,"register"],[85,18,83,16],[85,21,83,19],[85,27,83,19,"register"],[85,28,83,26,"phone"],[85,33,83,39],[85,35,83,41,"password"],[85,43,83,57],[85,45,83,59,"name"],[85,49,83,71],[85,54,83,76],[86,6,84,4],[86,12,84,10,"response"],[86,20,84,18],[86,23,84,21],[86,29,84,27,"api"],[86,41,84,30],[86,42,84,30,"api"],[86,45,84,30],[86,46,84,31,"post"],[86,50,84,35],[86,51,84,36],[86,67,84,52],[86,69,84,54],[87,8,84,56,"phone"],[87,13,84,61],[88,8,84,63,"password"],[88,16,84,71],[89,8,84,73,"name"],[90,6,84,78],[90,7,84,79],[90,8,84,80],[91,6,85,4],[91,12,85,10],[92,8,85,12,"access_token"],[92,20,85,24],[93,8,85,26,"user"],[93,12,85,30],[93,14,85,32,"userData"],[94,6,85,41],[94,7,85,42],[94,10,85,45,"response"],[94,18,85,53],[94,19,85,54,"data"],[94,23,85,58],[95,6,86,4],[95,12,86,10,"AsyncStorage"],[95,24,86,22],[95,25,86,22,"default"],[95,32,86,22],[95,33,86,23,"setItem"],[95,40,86,30],[95,41,86,31],[95,56,86,46],[95,58,86,48,"access_token"],[95,70,86,60],[95,71,86,61],[96,6,87,4,"setToken"],[96,14,87,12],[96,15,87,13,"access_token"],[96,27,87,25],[96,28,87,26],[97,6,88,4,"setUser"],[97,13,88,11],[97,14,88,12,"userData"],[97,22,88,20],[97,23,88,21],[98,4,89,2],[98,5,89,3],[99,4,91,2],[99,10,91,8,"logout"],[99,16,91,14],[99,19,91,17],[99,25,91,17,"logout"],[99,26,91,17],[99,31,91,29],[100,6,92,4],[100,12,92,10,"AsyncStorage"],[100,24,92,22],[100,25,92,22,"default"],[100,32,92,22],[100,33,92,23,"removeItem"],[100,43,92,33],[100,44,92,34],[100,59,92,49],[100,60,92,50],[101,6,93,4,"setToken"],[101,14,93,12],[101,15,93,13],[101,19,93,17],[101,20,93,18],[102,6,94,4,"setUser"],[102,13,94,11],[102,14,94,12],[102,18,94,16],[102,19,94,17],[103,4,95,2],[103,5,95,3],[104,4,97,2],[104,24,98,4],[104,28,98,4,"_reactJsxDevRuntime"],[104,47,98,4],[104,48,98,4,"jsxDEV"],[104,54,98,4],[104,56,98,5,"AuthContext"],[104,67,98,16],[104,68,98,17,"Provider"],[104,76,98,25],[105,6,99,6,"value"],[105,11,99,11],[105,13,99,13],[106,8,100,8,"user"],[106,12,100,12],[107,8,101,8,"token"],[107,13,101,13],[108,8,102,8,"isLoading"],[108,17,102,17],[109,8,103,8,"hasAcceptedPrivacy"],[109,26,103,26],[110,8,104,8,"login"],[110,13,104,13],[111,8,105,8,"register"],[111,16,105,16],[112,8,106,8,"logout"],[112,14,106,14],[113,8,107,8,"sendVerificationCode"],[113,28,107,28],[114,8,108,8,"verifyCode"],[114,18,108,18],[115,8,109,8,"acceptPrivacyPolicy"],[116,6,110,6],[116,7,110,8],[117,6,110,8,"children"],[117,14,110,8],[117,16,112,7,"children"],[118,4,112,15],[119,6,112,15,"fileName"],[119,14,112,15],[119,16,112,15,"_jsxFileName"],[119,28,112,15],[120,6,112,15,"lineNumber"],[120,16,112,15],[121,6,112,15,"columnNumber"],[121,18,112,15],[122,4,112,15],[122,11,113,26],[122,12,113,27],[123,2,115,0],[124,2,115,1,"_s"],[124,4,115,1],[124,5,29,16,"AuthProvider"],[124,17,29,28],[125,2,29,28,"_c"],[125,4,29,28],[125,7,29,16,"AuthProvider"],[125,19,29,28],[126,2,117,7],[126,11,117,16,"useAuth"],[126,18,117,23,"useAuth"],[126,19,117,23],[126,21,117,26],[127,4,117,26,"_s2"],[127,7,117,26],[128,4,118,2],[128,10,118,8,"context"],[128,17,118,15],[128,20,118,18],[128,24,118,18,"useContext"],[128,30,118,28],[128,31,118,28,"useContext"],[128,41,118,28],[128,43,118,29,"AuthContext"],[128,54,118,40],[128,55,118,41],[129,4,119,2],[129,8,119,6,"context"],[129,15,119,13],[129,20,119,18,"undefined"],[129,29,119,27],[129,31,119,29],[130,6,120,4],[130,12,120,10],[130,16,120,14,"Error"],[130,21,120,19],[130,22,120,20],[130,67,120,65],[130,68,120,66],[131,4,121,2],[132,4,122,2],[132,11,122,9,"context"],[132,18,122,16],[133,2,123,0],[134,2,123,1,"_s2"],[134,5,123,1],[134,6,117,16,"useAuth"],[134,13,117,23],[135,2,117,23],[135,6,117,23,"_c"],[135,8,117,23],[136,2,117,23,"$RefreshReg$"],[136,14,117,23],[136,15,117,23,"_c"],[136,17,117,23],[137,0,117,23],[137,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadStoredAuth","acceptPrivacyPolicy","sendVerificationCode","verifyCode","login","register","logout","useAuth"],"mappings":"AAA;OC4B;YCM;GDE;yBEE;GFmB;8BGE;GHG;+BIE;GJG;qBKE;GLG;gBME;GNM;mBOE;GPM;iBQE;GRI;CDoB;OUE;CVM"},"hasCjsExports":false},"type":"js/module"}]}