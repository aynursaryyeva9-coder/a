{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":38,"index":198}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const PRIVACY_ACCEPTED_KEY = 'vitamed_privacy_accepted';\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [hasAcceptedPrivacy, setHasAcceptedPrivacy] = (0, _react.useState)(false);\n    (0, _react.useEffect)(() => {\n      loadStoredAuth();\n    }, []);\n    const loadStoredAuth = async () => {\n      try {\n        // Check privacy policy acceptance\n        const privacyAccepted = await AsyncStorage.default.getItem(PRIVACY_ACCEPTED_KEY);\n        setHasAcceptedPrivacy(privacyAccepted === 'true');\n\n        // Check stored token\n        const storedToken = await AsyncStorage.default.getItem('vitamed_token');\n        if (storedToken) {\n          const response = await _servicesApi.api.get(`/auth/me?token=${storedToken}`);\n          setUser(response.data);\n          setToken(storedToken);\n        }\n      } catch (error) {\n        console.log('No stored auth or invalid token');\n        await AsyncStorage.default.removeItem('vitamed_token');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const acceptPrivacyPolicy = async () => {\n      await AsyncStorage.default.setItem(PRIVACY_ACCEPTED_KEY, 'true');\n      setHasAcceptedPrivacy(true);\n    };\n    const sendVerificationCode = async phone => {\n      const response = await _servicesApi.api.post('/auth/send-code', {\n        phone\n      });\n      return response.data.demo_code;\n    };\n    const verifyCode = async (phone, code) => {\n      const response = await _servicesApi.api.post('/auth/verify-code', {\n        phone,\n        code\n      });\n      return response.data.verified;\n    };\n    const login = async (phone, password) => {\n      const response = await _servicesApi.api.post('/auth/login', {\n        phone,\n        password\n      });\n      const {\n        access_token,\n        user: userData\n      } = response.data;\n      await AsyncStorage.default.setItem('vitamed_token', access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const register = async (phone, password, name) => {\n      const response = await _servicesApi.api.post('/auth/register', {\n        phone,\n        password,\n        name\n      });\n      const {\n        access_token,\n        user: userData\n      } = response.data;\n      await AsyncStorage.default.setItem('vitamed_token', access_token);\n      setToken(access_token);\n      setUser(userData);\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('vitamed_token');\n      setToken(null);\n      setUser(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        token,\n        isLoading,\n        hasAcceptedPrivacy,\n        login,\n        register,\n        logout,\n        sendVerificationCode,\n        verifyCode,\n        acceptPrivacyPolicy\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":128,"map":[[13,2,29,0,"exports"],[13,9,29,0],[13,10,29,0,"AuthProvider"],[13,22,29,0],[13,25,29,0,"AuthProvider"],[13,37,29,0],[14,2,117,0,"exports"],[14,9,117,0],[14,10,117,0,"useAuth"],[14,17,117,0],[14,20,117,0,"useAuth"],[14,27,117,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_servicesApi"],[18,18,3,0],[18,21,3,0,"require"],[18,28,3,0],[18,29,3,0,"_dependencyMap"],[18,43,3,0],[19,2,3,38],[19,6,3,38,"_reactJsxDevRuntime"],[19,25,3,38],[19,28,3,38,"require"],[19,35,3,38],[19,36,3,38,"_dependencyMap"],[19,50,3,38],[20,2,25,0],[20,8,25,6,"AuthContext"],[20,19,25,17],[20,35,25,20],[20,39,25,20,"createContext"],[20,45,25,33],[20,46,25,33,"createContext"],[20,59,25,33],[20,61,25,63,"undefined"],[20,70,25,72],[20,71,25,73],[21,2,27,0],[21,8,27,6,"PRIVACY_ACCEPTED_KEY"],[21,28,27,26],[21,31,27,29],[21,57,27,55],[22,2,29,7],[22,11,29,16,"AuthProvider"],[22,23,29,28,"AuthProvider"],[22,24,29,29],[23,4,29,31,"children"],[24,2,29,65],[24,3,29,66],[24,5,29,68],[25,4,30,2],[25,10,30,8],[25,11,30,9,"user"],[25,15,30,13],[25,17,30,15,"setUser"],[25,24,30,22],[25,25,30,23],[25,28,30,26],[25,32,30,26,"useState"],[25,38,30,34],[25,39,30,34,"useState"],[25,47,30,34],[25,49,30,48],[25,53,30,52],[25,54,30,53],[26,4,31,2],[26,10,31,8],[26,11,31,9,"token"],[26,16,31,14],[26,18,31,16,"setToken"],[26,26,31,24],[26,27,31,25],[26,30,31,28],[26,34,31,28,"useState"],[26,40,31,36],[26,41,31,36,"useState"],[26,49,31,36],[26,51,31,52],[26,55,31,56],[26,56,31,57],[27,4,32,2],[27,10,32,8],[27,11,32,9,"isLoading"],[27,20,32,18],[27,22,32,20,"setIsLoading"],[27,34,32,32],[27,35,32,33],[27,38,32,36],[27,42,32,36,"useState"],[27,48,32,44],[27,49,32,44,"useState"],[27,57,32,44],[27,59,32,45],[27,63,32,49],[27,64,32,50],[28,4,33,2],[28,10,33,8],[28,11,33,9,"hasAcceptedPrivacy"],[28,29,33,27],[28,31,33,29,"setHasAcceptedPrivacy"],[28,52,33,50],[28,53,33,51],[28,56,33,54],[28,60,33,54,"useState"],[28,66,33,62],[28,67,33,62,"useState"],[28,75,33,62],[28,77,33,63],[28,82,33,68],[28,83,33,69],[29,4,35,2],[29,8,35,2,"useEffect"],[29,14,35,11],[29,15,35,11,"useEffect"],[29,24,35,11],[29,26,35,12],[29,32,35,18],[30,6,36,4,"loadStoredAuth"],[30,20,36,18],[30,21,36,19],[30,22,36,20],[31,4,37,2],[31,5,37,3],[31,7,37,5],[31,9,37,7],[31,10,37,8],[32,4,39,2],[32,10,39,8,"loadStoredAuth"],[32,24,39,22],[32,27,39,25],[32,33,39,25,"loadStoredAuth"],[32,34,39,25],[32,39,39,37],[33,6,40,4],[33,10,40,8],[34,8,41,6],[35,8,42,6],[35,14,42,12,"privacyAccepted"],[35,29,42,27],[35,32,42,30],[35,38,42,36,"AsyncStorage"],[35,50,42,48],[35,51,42,48,"default"],[35,58,42,48],[35,59,42,49,"getItem"],[35,66,42,56],[35,67,42,57,"PRIVACY_ACCEPTED_KEY"],[35,87,42,77],[35,88,42,78],[36,8,43,6,"setHasAcceptedPrivacy"],[36,29,43,27],[36,30,43,28,"privacyAccepted"],[36,45,43,43],[36,50,43,48],[36,56,43,54],[36,57,43,55],[38,8,45,6],[39,8,46,6],[39,14,46,12,"storedToken"],[39,25,46,23],[39,28,46,26],[39,34,46,32,"AsyncStorage"],[39,46,46,44],[39,47,46,44,"default"],[39,54,46,44],[39,55,46,45,"getItem"],[39,62,46,52],[39,63,46,53],[39,78,46,68],[39,79,46,69],[40,8,47,6],[40,12,47,10,"storedToken"],[40,23,47,21],[40,25,47,23],[41,10,48,8],[41,16,48,14,"response"],[41,24,48,22],[41,27,48,25],[41,33,48,31,"api"],[41,45,48,34],[41,46,48,34,"api"],[41,49,48,34],[41,50,48,35,"get"],[41,53,48,38],[41,54,48,39],[41,72,48,57,"storedToken"],[41,83,48,68],[41,85,48,70],[41,86,48,71],[42,10,49,8,"setUser"],[42,17,49,15],[42,18,49,16,"response"],[42,26,49,24],[42,27,49,25,"data"],[42,31,49,29],[42,32,49,30],[43,10,50,8,"setToken"],[43,18,50,16],[43,19,50,17,"storedToken"],[43,30,50,28],[43,31,50,29],[44,8,51,6],[45,6,52,4],[45,7,52,5],[45,8,52,6],[45,15,52,13,"error"],[45,20,52,18],[45,22,52,20],[46,8,53,6,"console"],[46,15,53,13],[46,16,53,14,"log"],[46,19,53,17],[46,20,53,18],[46,53,53,51],[46,54,53,52],[47,8,54,6],[47,14,54,12,"AsyncStorage"],[47,26,54,24],[47,27,54,24,"default"],[47,34,54,24],[47,35,54,25,"removeItem"],[47,45,54,35],[47,46,54,36],[47,61,54,51],[47,62,54,52],[48,6,55,4],[48,7,55,5],[48,16,55,14],[49,8,56,6,"setIsLoading"],[49,20,56,18],[49,21,56,19],[49,26,56,24],[49,27,56,25],[50,6,57,4],[51,4,58,2],[51,5,58,3],[52,4,60,2],[52,10,60,8,"acceptPrivacyPolicy"],[52,29,60,27],[52,32,60,30],[52,38,60,30,"acceptPrivacyPolicy"],[52,39,60,30],[52,44,60,42],[53,6,61,4],[53,12,61,10,"AsyncStorage"],[53,24,61,22],[53,25,61,22,"default"],[53,32,61,22],[53,33,61,23,"setItem"],[53,40,61,30],[53,41,61,31,"PRIVACY_ACCEPTED_KEY"],[53,61,61,51],[53,63,61,53],[53,69,61,59],[53,70,61,60],[54,6,62,4,"setHasAcceptedPrivacy"],[54,27,62,25],[54,28,62,26],[54,32,62,30],[54,33,62,31],[55,4,63,2],[55,5,63,3],[56,4,65,2],[56,10,65,8,"sendVerificationCode"],[56,30,65,28],[56,33,65,31],[56,39,65,38,"phone"],[56,44,65,51],[56,48,65,73],[57,6,66,4],[57,12,66,10,"response"],[57,20,66,18],[57,23,66,21],[57,29,66,27,"api"],[57,41,66,30],[57,42,66,30,"api"],[57,45,66,30],[57,46,66,31,"post"],[57,50,66,35],[57,51,66,36],[57,68,66,53],[57,70,66,55],[58,8,66,57,"phone"],[59,6,66,63],[59,7,66,64],[59,8,66,65],[60,6,67,4],[60,13,67,11,"response"],[60,21,67,19],[60,22,67,20,"data"],[60,26,67,24],[60,27,67,25,"demo_code"],[60,36,67,34],[61,4,68,2],[61,5,68,3],[62,4,70,2],[62,10,70,8,"verifyCode"],[62,20,70,18],[62,23,70,21],[62,29,70,21,"verifyCode"],[62,30,70,28,"phone"],[62,35,70,41],[62,37,70,43,"code"],[62,41,70,55],[62,46,70,78],[63,6,71,4],[63,12,71,10,"response"],[63,20,71,18],[63,23,71,21],[63,29,71,27,"api"],[63,41,71,30],[63,42,71,30,"api"],[63,45,71,30],[63,46,71,31,"post"],[63,50,71,35],[63,51,71,36],[63,70,71,55],[63,72,71,57],[64,8,71,59,"phone"],[64,13,71,64],[65,8,71,66,"code"],[66,6,71,71],[66,7,71,72],[66,8,71,73],[67,6,72,4],[67,13,72,11,"response"],[67,21,72,19],[67,22,72,20,"data"],[67,26,72,24],[67,27,72,25,"verified"],[67,35,72,33],[68,4,73,2],[68,5,73,3],[69,4,75,2],[69,10,75,8,"login"],[69,15,75,13],[69,18,75,16],[69,24,75,16,"login"],[69,25,75,23,"phone"],[69,30,75,36],[69,32,75,38,"password"],[69,40,75,54],[69,45,75,59],[70,6,76,4],[70,12,76,10,"response"],[70,20,76,18],[70,23,76,21],[70,29,76,27,"api"],[70,41,76,30],[70,42,76,30,"api"],[70,45,76,30],[70,46,76,31,"post"],[70,50,76,35],[70,51,76,36],[70,64,76,49],[70,66,76,51],[71,8,76,53,"phone"],[71,13,76,58],[72,8,76,60,"password"],[73,6,76,69],[73,7,76,70],[73,8,76,71],[74,6,77,4],[74,12,77,10],[75,8,77,12,"access_token"],[75,20,77,24],[76,8,77,26,"user"],[76,12,77,30],[76,14,77,32,"userData"],[77,6,77,41],[77,7,77,42],[77,10,77,45,"response"],[77,18,77,53],[77,19,77,54,"data"],[77,23,77,58],[78,6,78,4],[78,12,78,10,"AsyncStorage"],[78,24,78,22],[78,25,78,22,"default"],[78,32,78,22],[78,33,78,23,"setItem"],[78,40,78,30],[78,41,78,31],[78,56,78,46],[78,58,78,48,"access_token"],[78,70,78,60],[78,71,78,61],[79,6,79,4,"setToken"],[79,14,79,12],[79,15,79,13,"access_token"],[79,27,79,25],[79,28,79,26],[80,6,80,4,"setUser"],[80,13,80,11],[80,14,80,12,"userData"],[80,22,80,20],[80,23,80,21],[81,4,81,2],[81,5,81,3],[82,4,83,2],[82,10,83,8,"register"],[82,18,83,16],[82,21,83,19],[82,27,83,19,"register"],[82,28,83,26,"phone"],[82,33,83,39],[82,35,83,41,"password"],[82,43,83,57],[82,45,83,59,"name"],[82,49,83,71],[82,54,83,76],[83,6,84,4],[83,12,84,10,"response"],[83,20,84,18],[83,23,84,21],[83,29,84,27,"api"],[83,41,84,30],[83,42,84,30,"api"],[83,45,84,30],[83,46,84,31,"post"],[83,50,84,35],[83,51,84,36],[83,67,84,52],[83,69,84,54],[84,8,84,56,"phone"],[84,13,84,61],[85,8,84,63,"password"],[85,16,84,71],[86,8,84,73,"name"],[87,6,84,78],[87,7,84,79],[87,8,84,80],[88,6,85,4],[88,12,85,10],[89,8,85,12,"access_token"],[89,20,85,24],[90,8,85,26,"user"],[90,12,85,30],[90,14,85,32,"userData"],[91,6,85,41],[91,7,85,42],[91,10,85,45,"response"],[91,18,85,53],[91,19,85,54,"data"],[91,23,85,58],[92,6,86,4],[92,12,86,10,"AsyncStorage"],[92,24,86,22],[92,25,86,22,"default"],[92,32,86,22],[92,33,86,23,"setItem"],[92,40,86,30],[92,41,86,31],[92,56,86,46],[92,58,86,48,"access_token"],[92,70,86,60],[92,71,86,61],[93,6,87,4,"setToken"],[93,14,87,12],[93,15,87,13,"access_token"],[93,27,87,25],[93,28,87,26],[94,6,88,4,"setUser"],[94,13,88,11],[94,14,88,12,"userData"],[94,22,88,20],[94,23,88,21],[95,4,89,2],[95,5,89,3],[96,4,91,2],[96,10,91,8,"logout"],[96,16,91,14],[96,19,91,17],[96,25,91,17,"logout"],[96,26,91,17],[96,31,91,29],[97,6,92,4],[97,12,92,10,"AsyncStorage"],[97,24,92,22],[97,25,92,22,"default"],[97,32,92,22],[97,33,92,23,"removeItem"],[97,43,92,33],[97,44,92,34],[97,59,92,49],[97,60,92,50],[98,6,93,4,"setToken"],[98,14,93,12],[98,15,93,13],[98,19,93,17],[98,20,93,18],[99,6,94,4,"setUser"],[99,13,94,11],[99,14,94,12],[99,18,94,16],[99,19,94,17],[100,4,95,2],[100,5,95,3],[101,4,97,2],[101,24,98,4],[101,28,98,4,"_reactJsxDevRuntime"],[101,47,98,4],[101,48,98,4,"jsxDEV"],[101,54,98,4],[101,56,98,5,"AuthContext"],[101,67,98,16],[101,68,98,17,"Provider"],[101,76,98,25],[102,6,99,6,"value"],[102,11,99,11],[102,13,99,13],[103,8,100,8,"user"],[103,12,100,12],[104,8,101,8,"token"],[104,13,101,13],[105,8,102,8,"isLoading"],[105,17,102,17],[106,8,103,8,"hasAcceptedPrivacy"],[106,26,103,26],[107,8,104,8,"login"],[107,13,104,13],[108,8,105,8,"register"],[108,16,105,16],[109,8,106,8,"logout"],[109,14,106,14],[110,8,107,8,"sendVerificationCode"],[110,28,107,28],[111,8,108,8,"verifyCode"],[111,18,108,18],[112,8,109,8,"acceptPrivacyPolicy"],[113,6,110,6],[113,7,110,8],[114,6,110,8,"children"],[114,14,110,8],[114,16,112,7,"children"],[115,4,112,15],[116,6,112,15,"fileName"],[116,14,112,15],[116,16,112,15,"_jsxFileName"],[116,28,112,15],[117,6,112,15,"lineNumber"],[117,16,112,15],[118,6,112,15,"columnNumber"],[118,18,112,15],[119,4,112,15],[119,11,113,26],[119,12,113,27],[120,2,115,0],[121,2,117,7],[121,11,117,16,"useAuth"],[121,18,117,23,"useAuth"],[121,19,117,23],[121,21,117,26],[122,4,118,2],[122,10,118,8,"context"],[122,17,118,15],[122,20,118,18],[122,24,118,18,"useContext"],[122,30,118,28],[122,31,118,28,"useContext"],[122,41,118,28],[122,43,118,29,"AuthContext"],[122,54,118,40],[122,55,118,41],[123,4,119,2],[123,8,119,6,"context"],[123,15,119,13],[123,20,119,18,"undefined"],[123,29,119,27],[123,31,119,29],[124,6,120,4],[124,12,120,10],[124,16,120,14,"Error"],[124,21,120,19],[124,22,120,20],[124,67,120,65],[124,68,120,66],[125,4,121,2],[126,4,122,2],[126,11,122,9,"context"],[126,18,122,16],[127,2,123,0],[128,0,123,1],[128,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadStoredAuth","acceptPrivacyPolicy","sendVerificationCode","verifyCode","login","register","logout","useAuth"],"mappings":"AAA;OC4B;YCM;GDE;yBEE;GFmB;8BGE;GHG;+BIE;GJG;qBKE;GLG;gBME;GNM;mBOE;GPM;iBQE;GRI;CDoB;OUE;CVM"},"hasCjsExports":false},"type":"js/module"}]}